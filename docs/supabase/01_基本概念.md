# 01. Supabaseの基本概念

## Supabaseとは

SupabaseはオープンソースのFirebase代替サービスです。PostgreSQLデータベースを中心に、認証、リアルタイム通信、ストレージなどの機能を提供します。

## 主要コンポーネント

### 1. Database（PostgreSQL）
- **本体**: PostgreSQL 15.x
- **拡張機能**: PostGIS、pg_vector、pgcrypto など
- **特徴**: Row Level Security (RLS)、トリガー、関数、ビュー

### 2. Auth（認証）
- メール/パスワード認証
- ソーシャルログイン（Google、GitHub等）
- マジックリンク
- JWT トークンベース

### 3. Storage（ストレージ）
- ファイルアップロード/ダウンロード
- バケット管理
- CDN統合
- アクセス制御

### 4. Realtime（リアルタイム）
- データベースの変更をリアルタイムで購読
- WebSocketベース
- Presence（オンライン状態管理）

### 5. Edge Functions
- Deno ランタイム
- サーバーレス関数
- TypeScript対応

## アーキテクチャ

```
┌─────────────────┐     ┌─────────────────┐
│   クライアント    │     │  Supabase CLI   │
│  (Web/Mobile)   │     │   (開発ツール)    │
└────────┬────────┘     └────────┬────────┘
         │                       │
         ▼                       ▼
┌─────────────────────────────────────────┐
│            API Gateway (Kong)           │
└────────┬────────────────────┬───────────┘
         │                    │
    ┌────▼─────┐         ┌───▼──────┐
    │ PostgREST│         │  GoTrue  │
    │  (API)   │         │  (Auth)  │
    └────┬─────┘         └──────────┘
         │
    ┌────▼─────────────────────────┐
    │      PostgreSQL Database     │
    │  ・テーブル                   │
    │  ・ビュー                     │
    │  ・関数                       │
    │  ・トリガー                   │
    │  ・RLS ポリシー               │
    └──────────────────────────────┘
```

## 環境の種類

### 1. ローカル環境
- Docker コンテナで動作
- 開発・テスト用
- 無料で無制限に使用可能
- オフラインでも動作

### 2. リモート環境（クラウド）
- Supabase がホスティング
- 本番環境用
- 無料枠あり（制限あり）
- 自動バックアップ、監視機能

## プロジェクト構造

```
fitness-tracker/
├── supabase/
│   ├── migrations/      # データベースマイグレーション
│   ├── functions/       # Edge Functions
│   ├── seed.sql        # シードデータ
│   └── config.toml     # プロジェクト設定
├── apps/
│   ├── web/            # Webアプリケーション
│   └── mobile/         # モバイルアプリケーション
└── packages/           # 共通パッケージ
```

## 基本的なワークフロー

1. **ローカルで開発**
   ```bash
   supabase start      # ローカル環境起動
   supabase status     # 状態確認
   ```

2. **マイグレーション作成**
   ```bash
   supabase migration new <名前>
   ```

3. **リモートへデプロイ**
   ```bash
   supabase db push    # スキーマをプッシュ
   supabase functions deploy  # 関数をデプロイ
   ```

4. **本番環境で運用**
   - ダッシュボードで監視
   - ログ確認
   - パフォーマンス調整

## 次のステップ

- [02. ローカル開発環境](./02_ローカル開発環境.md)
- [03. リモート環境との連携](./03_リモート環境との連携.md)